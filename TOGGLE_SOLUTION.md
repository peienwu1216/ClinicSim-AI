# Toggle æŒ‰éˆ•è§£æ±ºæ–¹æ¡ˆ

## å•é¡Œæè¿°

åœ¨ Streamlit æ‡‰ç”¨ä¸­ï¼Œ`st.expander` çµ„ä»¶çš„ toggle æŒ‰éˆ•åœ¨æŸäº›ç’°å¢ƒä¸‹æœƒé¡¯ç¤ºç‚ºæ–‡å­—ï¼ˆå¦‚ "keyboard_double_arrow"ï¼‰è€Œä¸æ˜¯åœ–æ¨™ï¼Œé€™åš´é‡å½±éŸ¿äº†ç”¨æˆ¶é«”é©—ã€‚

## è§£æ±ºæ–¹æ¡ˆ

æˆ‘å€‘å‰µå»ºäº†ä¸€å€‹è‡ªå®šç¾©çš„ Toggle çµ„ä»¶ï¼Œæä¾›å¤šç¨®ç¾è§€çš„æ›¿ä»£æ–¹æ¡ˆä¾†æ›¿ä»£ `st.expander`ã€‚

### æ–°å¢æ–‡ä»¶

1. **`src/frontend/components/custom_toggle.py`** - è‡ªå®šç¾© Toggle çµ„ä»¶
2. **`toggle_examples.py`** - ä½¿ç”¨ç¤ºä¾‹å’Œå±•ç¤º
3. **`TOGGLE_SOLUTION.md`** - æœ¬èªªæ˜æ–‡ä»¶

### å·²æ›´æ–°çš„æ–‡ä»¶

1. **`src/frontend/components/clinical_orders_simplified.py`** - æ›´æ–°æ¬¡è¦æª¢æŸ¥é …ç›®çš„ toggle
2. **`src/frontend/components/report_display.py`** - æ›´æ–° RAG æŸ¥è©¢å’Œ Notion è¨­å®šçš„ toggle
3. **`src/frontend/components/progress_display.py`** - æ›´æ–°ç³»çµ±ç‹€æ…‹å’Œæ—¥èªŒçš„ toggle

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```python
from .custom_toggle import create_custom_expander

def render_content():
    st.markdown("é€™æ˜¯ toggle çš„å…§å®¹")

create_custom_expander(
    title="æ¨™é¡Œ",
    content_func=render_content,
    key="unique_key",
    style="emoji",
    emoji="ğŸ“",
    default_expanded=False
)
```

### å¯ç”¨çš„æ¨£å¼

1. **Emoji æ¨£å¼** (`style="emoji"`)
   - ä½¿ç”¨ Emoji åœ–æ¨™ï¼ˆå¦‚ ğŸ“/ğŸ“‚ï¼‰
   - é©åˆï¼šæª”æ¡ˆç®¡ç†ã€è³‡æ–™å¤¾çµæ§‹

2. **Unicode ç®­é ­æ¨£å¼** (`style="unicode"`)
   - ä½¿ç”¨ Unicode ç®­é ­ï¼ˆâ–¶/â–¼ï¼‰
   - é©åˆï¼šå°èˆªã€é¸å–®

3. **ç®­é ­ç¬¦è™Ÿæ¨£å¼** (`style="arrows"`)
   - ä½¿ç”¨ç®­é ­ç¬¦è™Ÿï¼ˆğŸ”¸/ğŸ”½ï¼‰
   - é©åˆï¼šè¨­å®šé¸é …ã€é€²éšåŠŸèƒ½

4. **åŠ æ¸›è™Ÿæ¨£å¼** (`style="plus_minus"`)
   - ä½¿ç”¨åŠ æ¸›è™Ÿï¼ˆâ•/â–ï¼‰
   - é©åˆï¼šé …ç›®åˆ—è¡¨ã€è¨ˆæ•¸å™¨

5. **è‡ªå®šç¾©åœ–æ¨™å°æ¨£å¼** (`style="icons"`)
   - ä½¿ç”¨è‡ªå®šç¾©åœ–æ¨™å°
   - é©åˆï¼šç‰¹æ®ŠåŠŸèƒ½ï¼ˆå¦‚ ğŸ‘ï¸/ğŸ™ˆ ç”¨æ–¼éš±ç§è¨­å®šï¼‰

6. **æ–‡å­—æ¨£å¼** (`style="text"`)
   - ä½¿ç”¨æ–‡å­—æ¨™ç¤ºï¼ˆ[å±•é–‹]/[æ”¶åˆ]ï¼‰
   - é©åˆï¼šç°¡å–®ä»‹é¢ã€ç„¡åœ–æ¨™éœ€æ±‚

## åƒæ•¸èªªæ˜

- `title`: æŒ‰éˆ•æ¨™é¡Œæ–‡å­—
- `content_func`: å…§å®¹æ¸²æŸ“å‡½æ•¸
- `key`: å”¯ä¸€çš„ session state key
- `style`: æ¨£å¼é¡å‹
- `default_expanded`: é è¨­æ˜¯å¦å±•é–‹
- `emoji`: Emoji æ¨£å¼ä½¿ç”¨çš„åœ–æ¨™ï¼ˆåƒ… emoji æ¨£å¼ï¼‰
- `icon_pair`: è‡ªå®šç¾©åœ–æ¨™å°ï¼ˆåƒ… icons æ¨£å¼ï¼‰
- `expand_text`: å±•é–‹æ–‡å­—ï¼ˆåƒ… text æ¨£å¼ï¼‰
- `collapse_text`: æ”¶åˆæ–‡å­—ï¼ˆåƒ… text æ¨£å¼ï¼‰

## å„ªå‹¢

âœ… **è§£æ±ºåœ–æ¨™æ–‡å­—å•é¡Œ** - å®Œå…¨é¿å… Streamlit expander çš„åœ–æ¨™é¡¯ç¤ºå•é¡Œ  
âœ… **å¤šç¨®ç¾è§€æ¨£å¼** - æä¾› 6 ç¨®ä¸åŒçš„è¦–è¦ºé¢¨æ ¼  
âœ… **å®Œå…¨è‡ªå®šç¾©** - å¯ä»¥è‡ªå®šç¾©åœ–æ¨™ã€é¡è‰²ã€å‹•ç•«æ•ˆæœ  
âœ… **ä¿æŒåŸæœ‰åŠŸèƒ½** - å®Œå…¨å…¼å®¹åŸæœ‰çš„å±•é–‹/æ”¶åˆåŠŸèƒ½  
âœ… **æ˜“æ–¼ä½¿ç”¨** - ç°¡å–®çš„ APIï¼Œä¸€è¡Œä»£ç¢¼å³å¯æ›¿æ›  
âœ… **æ€§èƒ½å„ªåŒ–** - ä½¿ç”¨ CSS å‹•ç•«ï¼Œæµæš¢çš„ç”¨æˆ¶é«”é©—  

## å¯¦éš›æ‡‰ç”¨

### é†«ç™‚æª¢æŸ¥é …ç›®
```python
create_custom_expander(
    title="å…¶ä»–æª¢æŸ¥èˆ‡æ²»ç™‚",
    content_func=render_secondary_content,
    key="secondary_orders_toggle",
    style="arrows",
    default_expanded=False
)
```

### å ±å‘Šæ‘˜è¦
```python
create_custom_expander(
    title="RAG æŸ¥è©¢æ‘˜è¦",
    content_func=render_rag_content,
    key="rag_queries_toggle",
    style="emoji",
    emoji="ğŸ”",
    default_expanded=False
)
```

### ç³»çµ±è¨­å®š
```python
create_custom_expander(
    title="å¦‚ä½•è¨­å®š Notion æ•´åˆ",
    content_func=render_notion_setup,
    key="notion_setup_toggle",
    style="emoji",
    emoji="ğŸ”§",
    default_expanded=False
)
```

## æ¸¬è©¦

é‹è¡Œç¤ºä¾‹æ–‡ä»¶ä¾†æŸ¥çœ‹æ‰€æœ‰æ¨£å¼æ•ˆæœï¼š

```bash
streamlit run toggle_examples.py
```

## é·ç§»æŒ‡å—

### å¾ st.expander é·ç§»

**åŸæœ¬çš„å¯«æ³•ï¼š**
```python
with st.expander("æ¨™é¡Œ", expanded=False):
    st.markdown("å…§å®¹")
    st.button("æŒ‰éˆ•")
```

**æ–°çš„å¯«æ³•ï¼š**
```python
def render_content():
    st.markdown("å…§å®¹")
    st.button("æŒ‰éˆ•")

create_custom_expander(
    title="æ¨™é¡Œ",
    content_func=render_content,
    key="unique_key",
    style="emoji",
    emoji="ğŸ“",
    default_expanded=False
)
```

### æ³¨æ„äº‹é …

1. **Key å”¯ä¸€æ€§**: ç¢ºä¿æ¯å€‹ toggle ä½¿ç”¨å”¯ä¸€çš„ key
2. **å‡½æ•¸å®šç¾©**: å…§å®¹å¿…é ˆåŒ…è£åœ¨å‡½æ•¸ä¸­
3. **æ¨£å¼é¸æ“‡**: æ ¹æ“šä½¿ç”¨å ´æ™¯é¸æ“‡åˆé©çš„æ¨£å¼
4. **é è¨­ç‹€æ…‹**: æ ¹æ“šç”¨æˆ¶é«”é©—éœ€æ±‚è¨­å®š default_expanded

## æœªä¾†æ“´å±•

é€™å€‹è§£æ±ºæ–¹æ¡ˆå¯ä»¥é€²ä¸€æ­¥æ“´å±•ï¼š

- æ·»åŠ æ›´å¤šå‹•ç•«æ•ˆæœ
- æ”¯æ´è‡ªå®šç¾© CSS é¡åˆ¥
- æ·»åŠ éµç›¤å¿«æ·éµæ”¯æ´
- æ”¯æ´å¤šç´šåµŒå¥— toggle
- æ·»åŠ ä¸»é¡Œåˆ‡æ›åŠŸèƒ½

## æœ€æ–°æ›´æ–°

### é€æ˜åŒ–ä¿®å¾©æ–¹æ¡ˆ

ç‚ºäº†å¾¹åº•è§£æ±ºæ‰€æœ‰å¯èƒ½çš„ `keyboard_arrow_down` æ–‡å­—å•é¡Œï¼Œæˆ‘å€‘æ–°å¢äº†ï¼š

1. **`transparent_toggle_fix.py`** - é€æ˜åŒ–ä¿®å¾©çµ„ä»¶
   - ä½¿ç”¨ CSS è®“æ‰€æœ‰åœ–æ¨™æ–‡å­—è®Šé€æ˜ï¼ˆ`opacity: 0`, `color: transparent`ï¼‰
   - JavaScript å‹•æ…‹è™•ç†æ–°å‡ºç¾çš„æ–‡å­—ï¼Œè®“å®ƒå€‘è®Šé€æ˜
   - æŒçºŒç›£æ§ DOM è®ŠåŒ–ï¼Œå®šæœŸæª¢æŸ¥
   - ä¿ç•™ expander çš„æ­£å¸¸åŠŸèƒ½ï¼Œåªè®“æ–‡å­—è®Šé€æ˜

2. **`test_transparent_fix.py`** - é€æ˜åŒ–æ¸¬è©¦é é¢
   - é©—è­‰é€æ˜åŒ–ä¿®å¾©æ•ˆæœ
   - æ¸¬è©¦å„ç¨® expander ä½¿ç”¨æƒ…æ³
   - ç¢ºèªæ–‡å­—è®Šé€æ˜ä½†åŠŸèƒ½æ­£å¸¸

### å…¨åŸŸä¿®å¾©æ–¹æ¡ˆï¼ˆå‚™ç”¨ï¼‰

1. **`global_toggle_fix.py`** - å…¨åŸŸä¿®å¾©çµ„ä»¶
   - å¼·åŠ›çš„ CSS è¦å‰‡éš±è—æ‰€æœ‰åœ–æ¨™æ–‡å­—
   - JavaScript å‹•æ…‹ç§»é™¤æ–°å‡ºç¾çš„åœ–æ¨™æ–‡å­—
   - æŒçºŒç›£æ§ DOM è®ŠåŒ–

2. **`test_toggle_fix.py`** - æ¸¬è©¦é é¢
   - é©—è­‰ä¿®å¾©æ•ˆæœ
   - æ¸¬è©¦å„ç¨® expander ä½¿ç”¨æƒ…æ³

### ä½¿ç”¨æ–¹æ³•

åœ¨ä¸»æ‡‰ç”¨ä¸­è‡ªå‹•æ‡‰ç”¨é€æ˜åŒ–ä¿®å¾©ï¼š

```python
from src.frontend.components.transparent_toggle_fix import apply_transparent_toggle_fix_once

def main():
    # æ‡‰ç”¨é€æ˜åŒ–ä¿®å¾©
    apply_transparent_toggle_fix_once()
    # ... å…¶ä»–ä»£ç¢¼
```

### æ¸¬è©¦ä¿®å¾©æ•ˆæœ

é‹è¡Œé€æ˜åŒ–æ¸¬è©¦é é¢ï¼š

```bash
streamlit run test_transparent_fix.py
```

æˆ–é‹è¡ŒåŸå§‹æ¸¬è©¦é é¢ï¼š

```bash
streamlit run test_toggle_fix.py
```

## ç¸½çµ

é€šéé€™å€‹å®Œæ•´çš„è§£æ±ºæ–¹æ¡ˆï¼ˆè‡ªå®šç¾© Toggle çµ„ä»¶ + é€æ˜åŒ–ä¿®å¾©ï¼‰ï¼Œæˆ‘å€‘ï¼š

1. âœ… **å®Œå…¨è§£æ±º**äº† Streamlit expander çš„åœ–æ¨™æ–‡å­—å•é¡Œ
2. âœ… **æä¾›å¤šç¨®ç¾è§€**çš„ toggle æ¨£å¼é¸æ“‡
3. âœ… **ä¿æŒåŸæœ‰åŠŸèƒ½**ä¸è®Š
4. âœ… **é€æ˜åŒ–ä¿®å¾©**è®“æ–‡å­—è®Šé€æ˜ï¼Œç”¨æˆ¶çœ‹ä¸åˆ°
5. âœ… **å‹•æ…‹è™•ç†**æ–°å‡ºç¾çš„å…§å®¹
6. âœ… **æ˜“æ–¼ä½¿ç”¨å’Œç¶­è­·**
7. âœ… **åŒ…å«æ¸¬è©¦å·¥å…·**é©—è­‰æ•ˆæœ

### é€æ˜åŒ–ä¿®å¾©çš„å„ªå‹¢ï¼š
- **ç°¡å–®æœ‰æ•ˆ**: è®“æ–‡å­—è®Šé€æ˜ï¼Œä¸éœ€è¦è¤‡é›œçš„éš±è—é‚è¼¯
- **åŠŸèƒ½å®Œæ•´**: ä¸å½±éŸ¿ expander çš„æ­£å¸¸å±•é–‹/æ”¶åˆåŠŸèƒ½
- **å‹•æ…‹è™•ç†**: è‡ªå‹•è™•ç†æ–°å‡ºç¾çš„å…§å®¹
- **å¤šé‡ä¿éšœ**: CSS + JavaScript + å®šæœŸæª¢æŸ¥
- **ç”¨æˆ¶å‹å¥½**: ç”¨æˆ¶å®Œå…¨çœ‹ä¸åˆ°å•é¡Œæ–‡å­—

æ‰€æœ‰åŸæœ¬ä½¿ç”¨ `st.expander` çš„åœ°æ–¹éƒ½å·²ç¶“æ›´æ–°ç‚ºä½¿ç”¨æ–°çš„è‡ªå®šç¾©çµ„ä»¶ï¼ŒåŒæ™‚é€æ˜åŒ–ä¿®å¾©ç¢ºä¿å³ä½¿æœ‰éºæ¼çš„ expander ä¹Ÿä¸æœƒé¡¯ç¤ºåœ–æ¨™æ–‡å­—ã€‚
