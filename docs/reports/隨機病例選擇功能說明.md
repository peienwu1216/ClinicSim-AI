# 隨機病例選擇功能 - 臨床考試設計

## 🎯 功能概述

為了符合臨床考試的真實情境，系統現在支持隨機選擇病例進行問診練習，但**不會提前透露具體診斷**，讓學生通過問診來發現和診斷病情。

## 🎲 設計理念

### 臨床考試模擬
- **統一主訴**：所有病例都顯示「急性胸痛」作為主訴
- **隱藏診斷**：學生無法提前知道是ACS、肺栓塞、心包膜炎等具體診斷
- **真實情境**：模擬臨床實際情況，學生必須通過問診來收集資訊

### 教學價值
- **培養診斷思維**：學生需要從主訴開始，系統性地收集病史
- **提高鑑別能力**：面對相同主訴的不同疾病，學會鑑別診斷
- **增強臨床技能**：通過重複練習不同病例，提高問診技巧

## 📋 功能特點

### 1. 隨機選擇機制
- 系統隨機從4個可用病例中選擇
- 每次選擇都是不可預測的
- 教練可以隨時切換到新病例

### 2. 統一界面設計
- **頁面標題**：始終顯示「模擬診間：急性胸痛」
- **側邊欄信息**：顯示「目前主訴: 急性胸痛」
- **切換提示**：顯示「已切換到新病例，請開始問診」

### 3. 狀態管理
- 切換病例時自動清空對話歷史
- 重置所有評估指標和報告
- 提供全新的問診環境
- **問診開始後鎖定病例**：一旦開始問診，無法中途切換病例
- **問診結束後解鎖**：完成問診後可以選擇新病例開始新一輪練習

## 🏥 可用病例

系統包含4個不同的胸痛相關病例：

1. **急性冠心症 (ACS)**
   - 病人：王大明，55歲計程車司機
   - 特點：典型胸痛症狀，心血管風險因子

2. **不穩定心絞痛**
   - 病人：特魯希略．納西爾，53歲退休零售商
   - 特點：反覆胸痛，逐漸加重

3. **肺栓塞**
   - 病人：瑪莎．艾伯森，32歲時尚設計師
   - 特點：胸痛伴呼吸困難，危險因子

4. **心包膜炎**
   - 病人：特雷弗．雅各布，18歲大學生
   - 特點：胸痛伴發燒，年輕患者

## 🎯 使用流程

### 教練端操作
1. **初始階段**：點擊側邊欄的「🎲 隨機選擇病例」按鈕
2. **系統行為**：隨機選擇一個病例，自動重置所有狀態
3. **問診期間**：按鈕變為禁用狀態，顯示「⚠️ 問診已開始，無法切換病例」
4. **結束後**：按鈕變為「🎲 選擇新病例」，可以開始新一輪練習

### 學生體驗
1. 看到「急性胸痛」主訴
2. 通過問診收集病史（一旦開始問診，病例即被鎖定）
3. 進行鑑別診斷
4. 制定治療計畫
5. 獲得個性化回饋
6. 完成後可選擇新病例進行下一輪練習

## 🔍 教學優勢

### 對學生
- **真實挑戰**：每次都是未知病例，提高專注度
- **連續性保證**：一旦開始問診就無法中途換題，確保完整性
- **全面練習**：涵蓋不同類型的胸痛疾病
- **技能提升**：重複練習提高問診和診斷能力

### 對教練
- **靈活教學**：可以根據需要隨機選擇病例
- **客觀評估**：學生無法提前準備特定病例
- **多樣化訓練**：確保學生接觸到各種臨床情境

## 🚀 技術實現

- **後端API**：`GET /cases/random` 端點
- **前端界面**：Streamlit 側邊欄整合
- **狀態管理**：自動重置session state
- **錯誤處理**：完整的異常處理機制

這個設計完美符合臨床考試的要求，讓學生在真實的情境中練習問診技能，同時保持教學的客觀性和挑戰性。
